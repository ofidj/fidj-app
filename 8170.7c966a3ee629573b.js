"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8170],{8170:(S,h,p)=>{p.r(h),p.d(h,{AppsPageModule:()=>l});var n=p(4556),c=p(1407),u=p(6895),g=p(433),m=p(7582),A=p(2601),e=p(8256),v=p(5420),C=p(9251);function y(r,i){if(1&r&&(e.TgZ(0,"ion-item-sliding")(1,"ion-item")(2,"ion-label"),e._uU(3),e.qZA(),e.TgZ(4,"a",12),e._UZ(5,"img",13),e.qZA()()()),2&r){const t=i.$implicit;e.xp6(3),e.AsE("",t.title," - ",t.description,""),e.xp6(1),e.s9C("href",t.pub,e.LSH),e.xp6(1),e.s9C("src",t.badge,e.LSH)}}function T(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"New app"),e.qZA()()(),e.TgZ(4,"ion-content",14)(5,"ion-input",15),e.NdJ("ngModelChange",function(s){e.CHM(t);const f=e.oxw();return e.KtG(f.appNameToCreate=s)}),e.qZA(),e.TgZ(6,"ion-input",16),e.NdJ("ngModelChange",function(s){e.CHM(t);const f=e.oxw();return e.KtG(f.appDescriptionToCreate=s)}),e.qZA(),e.TgZ(7,"ion-button",17),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.createApp())}),e._uU(8,"Create "),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.appNameToCreate),e.xp6(1),e.Q6J("ngModel",t.appDescriptionToCreate)}}class a{constructor(i,t,o){this.router=i,this.fidjService=t,this.fidjConnectionService=o,this.refresh(null).then(s=>{})}refresh(i){return(0,m.mG)(this,void 0,void 0,function*(){let t={iss:""};try{yield this.fidjConnectionService.refresh();const s=(yield this.fidjService.getIdToken()).split(".")[1];t=JSON.parse(A.Base64.decode(s)),this.fidjConnectionService.setUrl(t.iss)}catch(o){return i&&i.target.complete(),yield this.fidjConnectionService.checkError(o)}this.profileAppsOwned=[];try{this.me=(yield this.fidjService.sendOnEndpoint({verb:"GET",key:"me",relativePath:"details",defaultKeyUrl:this.fidjConnectionService.getUrl("me")})).data;for(let o=0;o<this.me.user.appsOwned.length;o++){const s=(yield this.fidjService.sendOnEndpoint({verb:"GET",key:"apps",relativePath:this.me.user.appsOwned[o],defaultKeyUrl:this.fidjConnectionService.getUrl("apps")})).data.app;s.badge=this.fidjConnectionService.getUrl(`apps/${s.id}/badge`),s.pub=`#/pub/${s.id}`,this.profileAppsOwned.push(s)}}catch(o){yield this.fidjConnectionService.checkError(o)}i&&i.target.complete()})}createApp(){return(0,m.mG)(this,void 0,void 0,function*(){const i={title:this.appNameToCreate,description:this.appDescriptionToCreate};try{const t=(yield this.fidjService.sendOnEndpoint({verb:"POST",key:"apps",data:i,defaultKeyUrl:this.fidjConnectionService.getUrl("apps")})).data;yield this.modal.dismiss(t.app.title,"confirm")}catch{yield this.modal.dismiss(null,"cancel")}yield this.refresh(null)})}}a.\u0275fac=function(i){return new(i||a)(e.Y36(c.F0),e.Y36(v.FidjService),e.Y36(C.G))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-apps"]],viewQuery:function(i,t){if(1&i&&e.Gf(n.ki,5),2&i){let o;e.iGM(o=e.CRH())&&(t.modal=o.first)}},decls:22,vars:3,consts:[[3,"translucent"],["height","15em","src","assets/fidj-logo.png"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["collapse","condense"],["size","large"],["offset-md","2","size-md","8","size-sm","12"],[4,"ngFor","ngForOf"],["horizontal","end","slot","fixed","vertical","bottom"],["id","open-modal-create-app"],["name","add"],["trigger","open-modal-create-app"],[3,"href"],[3,"src"],[1,"ion-padding"],["placeholder","App name","required","","type","text",3,"ngModel","ngModelChange"],["placeholder","App description","required","","type","text",3,"ngModel","ngModelChange"],[3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._UZ(3,"img",1),e._uU(4," Apps "),e.qZA()()(),e.TgZ(5,"ion-content",2)(6,"ion-refresher",3),e.NdJ("ionRefresh",function(s){return t.refresh(s)}),e._UZ(7,"ion-refresher-content"),e.qZA(),e.TgZ(8,"ion-header",4)(9,"ion-toolbar")(10,"ion-title",5),e._uU(11,"Apps"),e.qZA()()(),e.TgZ(12,"ion-grid")(13,"ion-row")(14,"ion-col",6)(15,"ion-list"),e.YNc(16,y,6,4,"ion-item-sliding",7),e.qZA()()()(),e.TgZ(17,"ion-fab",8)(18,"ion-fab-button",9),e._UZ(19,"ion-icon",10),e.qZA()(),e.TgZ(20,"ion-modal",11),e.YNc(21,T,9,2,"ng-template"),e.qZA()()),2&i&&(e.Q6J("translucent",!0),e.xp6(5),e.Q6J("fullscreen",!0),e.xp6(11),e.Q6J("ngForOf",t.profileAppsOwned))},dependencies:[n.YG,n.wI,n.W2,n.IJ,n.W4,n.jY,n.Gu,n.gu,n.pK,n.Ie,n.td,n.Q$,n.q_,n.nJ,n.Wo,n.Nd,n.wd,n.sr,n.ki,n.j9,u.sg,g.JJ,g.Q7,g.On]});var Z=p(581);const j=[{path:"",component:a}];class d{}d.\u0275fac=function(i){return new(i||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[c.Bz.forChild(j),c.Bz]});class l{}l.\u0275fac=function(i){return new(i||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[n.Pc,u.ez,g.u5,Z.e,c.Bz.forChild([{path:"",component:a}]),d]})}}]);