"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9463],{9463:(P,u,n)=>{n.r(u),n.d(u,{GdprPageModule:()=>a});var o=n(4556),p=n(1407),f=n(6895),g=n(433),h=n(7582),m=n(2601),e=n(8256),v=n(5420),S=n(9251);function y(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item")(2,"ion-label"),e._uU(3),e.qZA(),e.TgZ(4,"a",9),e._UZ(5,"img",10),e.qZA()(),e.TgZ(6,"ion-item-options",11)(7,"ion-item-option",12),e.NdJ("click",function(){const Z=e.CHM(t).$implicit,b=e.oxw(2);return e.KtG(b.remove(Z))}),e._uU(8,"Remove all my data"),e.qZA()()()}if(2&r){const t=i.$implicit;e.xp6(3),e.AsE("",t.title," - ",t.description,""),e.xp6(1),e.s9C("href",t.pub,e.LSH),e.xp6(1),e.s9C("src",t.badge,e.LSH)}}function G(r,i){if(1&r&&(e.TgZ(0,"ion-list"),e.YNc(1,y,9,4,"ion-item-sliding",8),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.profileAppsSubscribed)}}class d{constructor(i,t,s){this.router=i,this.fidjService=t,this.fidjConnectionService=s,this.refresh(null)}refresh(i){return(0,h.mG)(this,void 0,void 0,function*(){let t={iss:""};try{yield this.fidjConnectionService.refresh();const c=(yield this.fidjService.getIdToken()).split(".")[1];t=JSON.parse(m.Base64.decode(c)),this.fidjConnectionService.setUrl(t.iss)}catch(s){return i&&i.target.complete(),yield this.fidjConnectionService.checkError(s)}this.profileAppsSubscribed=[];try{this.me=(yield this.fidjService.sendOnEndpoint({verb:"GET",key:"me",relativePath:"details"})).data;for(let s=0;s<this.me.user.appsSubscribed.length;s++){const c=(yield this.fidjService.sendOnEndpoint({verb:"GET",key:"apps",relativePath:this.me.user.appsSubscribed[s]})).data.app;console.log("app:",c),c.badge=this.fidjConnectionService.getUrl()+`/apps/${c.id}/badge`,c.pub=`#/pub/${c.id}`,this.profileAppsSubscribed.push(c)}}catch(s){yield this.fidjConnectionService.checkError(s)}i&&i.target.complete()})}remove(i){return(0,h.mG)(this,void 0,void 0,function*(){try{yield this.fidjService.sendOnEndpoint({verb:"DELETE",key:"apps",relativePath:i.id+"/contracts"})}catch(t){yield this.fidjConnectionService.checkError(t)}})}}d.\u0275fac=function(i){return new(i||d)(e.Y36(p.F0),e.Y36(v.FidjService),e.Y36(S.G))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-gdpr"]],decls:16,vars:3,consts:[[3,"translucent"],["src","assets/fidj-logo.png","height","15em"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["collapse","condense"],["size","large"],["size-md","8","offset-md","2","size-sm","12"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"href"],[3,"src"],["side","end"],["color","danger",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._UZ(3,"img",1),e._uU(4," GDPR "),e.qZA()()(),e.TgZ(5,"ion-content",2)(6,"ion-refresher",3),e.NdJ("ionRefresh",function(c){return t.refresh(c)}),e._UZ(7,"ion-refresher-content"),e.qZA(),e.TgZ(8,"ion-header",4)(9,"ion-toolbar")(10,"ion-title",5),e._uU(11,"GDPR"),e.qZA()()(),e.TgZ(12,"ion-grid")(13,"ion-row")(14,"ion-col",6),e.YNc(15,G,2,1,"ion-list",7),e.qZA()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(5),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("ngIf",t.profileAppsSubscribed))},dependencies:[o.wI,o.W2,o.jY,o.Gu,o.Ie,o.u8,o.IK,o.td,o.Q$,o.q_,o.nJ,o.Wo,o.Nd,o.wd,o.sr,f.sg,f.O5]});var j=n(581);const T=[{path:"",component:d}];class l{}l.\u0275fac=function(i){return new(i||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[p.Bz.forChild(T),p.Bz]});class a{}a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[o.Pc,f.ez,g.u5,j.e,p.Bz.forChild([{path:"",component:d}]),l]})}}]);